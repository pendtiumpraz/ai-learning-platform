function a(a,o){let e=0,i=a.length,n=!1;if(!o){if(a.startsWith("data:"))return null;for(;e<a.length&&a.charCodeAt(e)<=32;)e+=1;for(;i>e+1&&a.charCodeAt(i-1)<=32;)i-=1;if(47===a.charCodeAt(e)&&47===a.charCodeAt(e+1))e+=2;else{const o=a.indexOf(":/",e);if(-1!==o){const i=o-e,n=a.charCodeAt(e),s=a.charCodeAt(e+1),t=a.charCodeAt(e+2),r=a.charCodeAt(e+3),u=a.charCodeAt(e+4);if(5===i&&104===n&&116===s&&116===t&&112===r&&115===u);else if(4===i&&104===n&&116===s&&116===t&&112===r);else if(3===i&&119===n&&115===s&&115===t);else if(2===i&&119===n&&115===s);else for(let i=e;i<o;i+=1){const o=32|a.charCodeAt(i);if(!(o>=97&&o<=122||o>=48&&o<=57||46===o||45===o||43===o))return null}for(e=o+2;47===a.charCodeAt(e);)e+=1}}let o=-1,s=-1,t=-1;for(let r=e;r<i;r+=1){const e=a.charCodeAt(r);if(35===e||47===e||63===e){i=r;break}64===e?o=r:93===e?s=r:58===e?t=r:e>=65&&e<=90&&(n=!0)}if(-1!==o&&o>e&&o<i&&(e=o+1),91===a.charCodeAt(e))return-1!==s?a.slice(e+1,s).toLowerCase():null;-1!==t&&t>e&&t<i&&(i=t)}for(;i>e+1&&46===a.charCodeAt(i-1);)i-=1;const s=0!==e||i!==a.length?a.slice(e,i):a;return n?s.toLowerCase():s}function o(a){return a>=97&&a<=122||a>=48&&a<=57||a>127}function e(a){if(a.length>255)return!1;if(0===a.length)return!1;if(!o(a.charCodeAt(0))&&46!==a.charCodeAt(0)&&95!==a.charCodeAt(0))return!1;let e=-1,i=-1;const n=a.length;for(let s=0;s<n;s+=1){const n=a.charCodeAt(s);if(46===n){if(s-e>64||46===i||45===i||95===i)return!1;e=s}else if(!o(n)&&45!==n&&95!==n)return!1;i=n}return n-e-1<=63&&45!==i}const i=function({allowIcannDomains:a=!0,allowPrivateDomains:o=!1,detectIp:e=!0,extractHostname:i=!0,mixedInputs:n=!0,validHosts:s=null,validateHostname:t=!0}){return{allowIcannDomains:a,allowPrivateDomains:o,detectIp:e,extractHostname:i,mixedInputs:n,validHosts:s,validateHostname:t}}({});function n(o,n,s,t,r){const u=function(a){return void 0===a?i:function({allowIcannDomains:a=!0,allowPrivateDomains:o=!1,detectIp:e=!0,extractHostname:i=!0,mixedInputs:n=!0,validHosts:s=null,validateHostname:t=!0}){return{allowIcannDomains:a,allowPrivateDomains:o,detectIp:e,extractHostname:i,mixedInputs:n,validHosts:s,validateHostname:t}}(a)}(t);return"string"!=typeof o?r:(u.extractHostname?u.mixedInputs?r.hostname=a(o,e(o)):r.hostname=a(o,!1):r.hostname=o,0===n||null===r.hostname||u.detectIp&&(r.isIp=function(a){if(a.length<3)return!1;let o=a.startsWith("[")?1:0,e=a.length;if("]"===a[e-1]&&(e-=1),e-o>39)return!1;let i=!1;for(;o<e;o+=1){const e=a.charCodeAt(o);if(58===e)i=!0;else if(!(e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=90))return!1}return i}(l=r.hostname)||function(a){if(a.length<7)return!1;if(a.length>15)return!1;let o=0;for(let e=0;e<a.length;e+=1){const i=a.charCodeAt(e);if(46===i)o+=1;else if(i<48||i>57)return!1}return 3===o&&46!==a.charCodeAt(0)&&46!==a.charCodeAt(a.length-1)}(l),r.isIp)?r:u.validateHostname&&u.extractHostname&&!e(r.hostname)?(r.hostname=null,r):(s(r.hostname,u,r),2===n||null===r.publicSuffix?r:(r.domain=function(a,o,e){if(null!==e.validHosts){const a=e.validHosts;for(const e of a)if(function(a,o){return!!a.endsWith(o)&&(a.length===o.l